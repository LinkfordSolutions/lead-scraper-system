# 🎯 Lead Scraper System

Автоматизированная система сбора контактов компаний и специалистов из Беларуси с доставкой через Telegram бота.

[![Status](https://img.shields.io/badge/status-production%20ready-success)](https://github.com/LinkfordSolutions/lead-scraper-system)
[![Python](https://img.shields.io/badge/python-3.10-blue)](https://www.python.org/)
[![PostgreSQL](https://img.shields.io/badge/database-PostgreSQL%2014-blue)](https://www.postgresql.org/)

---

## 📋 О проекте

Lead Scraper System - это комплексное решение для автоматического сбора бизнес-лидов из различных источников в Беларуси. Система парсит данные из 6 источников, дедуплицирует их, сохраняет в PostgreSQL и ежедневно отправляет обновленную базу в виде CSV файла через Telegram бота.

### ✨ Основные возможности

- 🤖 **Telegram бот** с защитой паролем
- 🔄 **Автоматический парсинг** каждый день в 03:00 UTC
- 📊 **6 источников данных**: 2GIS, Яндекс Карты, EGR.gov.by, Onliner, Deal, Instagram
- 🎯 **10 бизнес-категорий**: от автосервисов до тату-салонов
- 💾 **PostgreSQL** для хранения и дедупликации
- 📤 **Автоотправка CSV** всем авторизованным пользователям
- 🇧🇾 **Полный охват Беларуси** (все регионы)

## 🎯 Целевые ниши

1. СТО/детейлинг/шиномонтаж
2. Мастер на час / электрик / сантехник / бытовая техника
3. Клининговые услуги
4. Грузоперевозки/переезды
5. Учителя/репетиторы/курсы
6. Фитнес/йога/танцы/ЕМС-студии
7. Фото/видео-студии, фотографы
8. Нотариус/юристы/консалтинг
9. Психологи/коучи
10. Тату/перманент/пирсинг

## 📊 Источники данных

| Источник | Тип | API ключ | Надежность | Контакты |
|----------|-----|----------|------------|----------|
| 2GIS | API | Опционально | ★★★★★ | Телефон, сайт |
| Яндекс Карты | API | Требуется | ★★★★★ | Телефон, сайт |
| EGR.gov.by | API | Нет | ★★★★★ | Только легальные |
| Onliner.by | Scraping | Нет | ★★★☆☆ | Телефон, объявления |
| Deal.by | Scraping | Нет | ★★★☆☆ | Телефон, объявления |
| Instagram | Scraping | Опционально | ★★★☆☆ | Профиль, био |

## 🏗️ Архитектура

```
┌──────────────┐
│   PARSERS    │ → Сбор данных из источников
└──────┬───────┘
       ↓
┌──────────────┐
│  CLASSIFIER  │ → Автоматическая категоризация
└──────┬───────┘
       ↓
┌──────────────┐
│   DATABASE   │ → PostgreSQL хранилище
└──────┬───────┘
       ↓
┌──────────────┐
│ DEDUPLICATOR │ → Объединение дубликатов
└──────┬───────┘
       ↓
┌──────────────┐
│ CSV EXPORTER │ → Экспорт в CSV
└──────┬───────┘
       ↓
┌──────────────┐
│ TELEGRAM BOT │ → Доставка лидов
└──────────────┘
```

## 🚀 Установка

```bash
# Клонировать репозиторий
git clone https://github.com/LinkfordSolutions/lead-scraper-system.git
cd lead-scraper-system

# Создать виртуальное окружение
python3 -m venv venv
source venv/bin/activate

# Установить зависимости
pip install -r requirements.txt

# Настроить .env
cp .env.example .env
# Отредактировать .env с вашими токенами
```

## ⚙️ Конфигурация

Создайте файл `.env` на основе `.env.example`:

```env
# Telegram Bot
TELEGRAM_BOT_TOKEN=your_bot_token
BOT_PASSWORD=your_generated_password

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/lead_scraper

# Scheduler
SCRAPING_SCHEDULE=daily
SCRAPING_TIME=03:00
```

## 📝 Использование

### Запуск системы

```bash
# Запуск в фоне
./start_background.sh

# Проверка статуса
./status.sh

# Просмотр логов
tail -f logs/app_run.log

# Остановка
./stop.sh
```

### Telegram бот

1. Найти в Telegram: **@TargetLink_lead_bot**
2. Нажать `/start`
3. Авторизоваться с паролем: `qcW5be4mczNVFs3v`

| Кнопка | Описание |
|--------|----------|
| 📊 Получить лиды | Скачать актуальный CSV с компаниями |
| 📈 Статус парсинга | Посмотреть статистику последнего парсинга |
| ℹ️ Помощь | Получить справку по использованию |

## 📦 Структура данных CSV

Экспортируемые поля:

- **Название компании**
- **Адрес**
- **Телефон**
- **Email**
- **Сайт**
- **Instagram**
- **Категория** (ниша)
- **Рейтинг**
- **Количество отзывов**
- **Координаты** (широта, долгота)
- **Район/Город**
- **Источник данных**
- **Дата обновления**

## 🔄 Автоматическое обновление

Система автоматически запускает парсинг **1 раз в день** в 03:00 по UTC.

После завершения парсинга:
1. Данные обрабатываются и дедуплицируются
2. Создается CSV файл
3. Файл автоматически отправляется всем авторизованным пользователям в Telegram

## 🛡️ Безопасность

- Доступ к боту защищен паролем
- Токены хранятся в `.env` (не коммитятся в git)
- Rate limiting для всех парсеров
- Proxy rotation для избежания блокировок

## 📊 Мониторинг

Логи доступны в директории `logs/`:
- `scraper.log` - основные операции парсинга
- `bot.log` - активность Telegram бота
- `errors.log` - ошибки системы

## 🤝 Поддержка

При возникновении проблем создайте issue в репозитории.

## 📄 Лицензия

Proprietary - LinkfordSolutions © 2025
